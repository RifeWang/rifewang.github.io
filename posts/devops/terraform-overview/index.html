<!doctype html><html lang=en><head><title>Terraform: 基础设施即代码 · 凌虚 Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="凌虚"><meta name=description content="Terraform: 基础设施即代码 Link to heading 问题 Link to heading 现如今有很多 IT 系统的基础设施直接使用了云厂商提供的服务，假设我们需要构建以下基础设施：
VPC 网络 虚拟主机 负载均衡器 数据库 文件存储 &mldr; 那么在公有云的环境中，我们一般怎么做？
在云厂商提供的前端管理页面上手动操作吗？
这也太费劲了吧，尤其是当基础设施越来越多、越来越复杂、以及跨多个云环境的时候，这些基础设施的配置和管理便会碰到一个巨大的挑战。
Terraform Link to heading 为了解决上述问题，Terrafrom 应运而生。
使用 Terraform ，我们只需要编写简单的声明式代码，形如：
... resource &#34;alicloud_db_instance&#34; &#34;instance&#34; { engine = &#34;MySQL&#34; engine_version = &#34;5.6&#34; instance_type = &#34;rds.mysql.s1.small&#34; instance_storage = &#34;10&#34; ... } 然后执行几个简单的 terraform 命令便可以轻松创建一个阿里云的数据库实例。
这就是 Infrastructure as code 基础设施即代码。也就是通过代码而不是手动流程来管理和配置基础设施。
正如其官方文档所述，与手动管理基础设施相比，使用 Terraform 有以下几个优势：
Terraform 可以轻松管理多个云平台上的基础设施。 使用人类可读的声明式的配置语言，有助于快速编写基础设施代码。 Terraform 的状态允许您在整个部署过程中跟踪资源更改。 可以对这些基础设施代码进行版本控制，从而安全地进行协作。 Provider & Module Link to heading 你也许会感到困惑，我只是简单的应用了所写的声明式代码，怎么就构建出来了基础设施，这中间发生了什么？"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Terraform: 基础设施即代码"><meta name=twitter:description content="Terraform: 基础设施即代码 Link to heading 问题 Link to heading 现如今有很多 IT 系统的基础设施直接使用了云厂商提供的服务，假设我们需要构建以下基础设施：
VPC 网络 虚拟主机 负载均衡器 数据库 文件存储 &mldr; 那么在公有云的环境中，我们一般怎么做？
在云厂商提供的前端管理页面上手动操作吗？
这也太费劲了吧，尤其是当基础设施越来越多、越来越复杂、以及跨多个云环境的时候，这些基础设施的配置和管理便会碰到一个巨大的挑战。
Terraform Link to heading 为了解决上述问题，Terrafrom 应运而生。
使用 Terraform ，我们只需要编写简单的声明式代码，形如：
... resource &#34;alicloud_db_instance&#34; &#34;instance&#34; { engine = &#34;MySQL&#34; engine_version = &#34;5.6&#34; instance_type = &#34;rds.mysql.s1.small&#34; instance_storage = &#34;10&#34; ... } 然后执行几个简单的 terraform 命令便可以轻松创建一个阿里云的数据库实例。
这就是 Infrastructure as code 基础设施即代码。也就是通过代码而不是手动流程来管理和配置基础设施。
正如其官方文档所述，与手动管理基础设施相比，使用 Terraform 有以下几个优势：
Terraform 可以轻松管理多个云平台上的基础设施。 使用人类可读的声明式的配置语言，有助于快速编写基础设施代码。 Terraform 的状态允许您在整个部署过程中跟踪资源更改。 可以对这些基础设施代码进行版本控制，从而安全地进行协作。 Provider & Module Link to heading 你也许会感到困惑，我只是简单的应用了所写的声明式代码，怎么就构建出来了基础设施，这中间发生了什么？"><meta property="og:title" content="Terraform: 基础设施即代码"><meta property="og:description" content="Terraform: 基础设施即代码 Link to heading 问题 Link to heading 现如今有很多 IT 系统的基础设施直接使用了云厂商提供的服务，假设我们需要构建以下基础设施：
VPC 网络 虚拟主机 负载均衡器 数据库 文件存储 &mldr; 那么在公有云的环境中，我们一般怎么做？
在云厂商提供的前端管理页面上手动操作吗？
这也太费劲了吧，尤其是当基础设施越来越多、越来越复杂、以及跨多个云环境的时候，这些基础设施的配置和管理便会碰到一个巨大的挑战。
Terraform Link to heading 为了解决上述问题，Terrafrom 应运而生。
使用 Terraform ，我们只需要编写简单的声明式代码，形如：
... resource &#34;alicloud_db_instance&#34; &#34;instance&#34; { engine = &#34;MySQL&#34; engine_version = &#34;5.6&#34; instance_type = &#34;rds.mysql.s1.small&#34; instance_storage = &#34;10&#34; ... } 然后执行几个简单的 terraform 命令便可以轻松创建一个阿里云的数据库实例。
这就是 Infrastructure as code 基础设施即代码。也就是通过代码而不是手动流程来管理和配置基础设施。
正如其官方文档所述，与手动管理基础设施相比，使用 Terraform 有以下几个优势：
Terraform 可以轻松管理多个云平台上的基础设施。 使用人类可读的声明式的配置语言，有助于快速编写基础设施代码。 Terraform 的状态允许您在整个部署过程中跟踪资源更改。 可以对这些基础设施代码进行版本控制，从而安全地进行协作。 Provider & Module Link to heading 你也许会感到困惑，我只是简单的应用了所写的声明式代码，怎么就构建出来了基础设施，这中间发生了什么？"><meta property="og:type" content="article"><meta property="og:url" content="https://rifewang.github.io/posts/devops/terraform-overview/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-27T00:00:00+08:00"><meta property="article:modified_time" content="2022-03-27T00:00:00+08:00"><link rel=canonical href=https://rifewang.github.io/posts/devops/terraform-overview/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.0fa2dc75ed1b76894ac0e062b10a6c4730daa745096fa120114b290ed8a48788.css integrity="sha256-D6Lcde0bdolKwOBisQpsRzDap0UJb6EgEUspDtikh4g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.110.0"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>凌虚 Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://rifewang.github.io/posts/devops/terraform-overview/>Terraform: 基础设施即代码</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2022-03-27T00:00:00+08:00>March 27, 2022</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
One-minute read</span></div></div></header><div class=post-content><h1 id=terraform-基础设施即代码>Terraform: 基础设施即代码
<a class=heading-link href=#terraform-%e5%9f%ba%e7%a1%80%e8%ae%be%e6%96%bd%e5%8d%b3%e4%bb%a3%e7%a0%81><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><h2 id=问题>问题
<a class=heading-link href=#%e9%97%ae%e9%a2%98><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>现如今有很多 IT 系统的基础设施直接使用了云厂商提供的服务，假设我们需要构建以下基础设施：</p><ul><li>VPC 网络</li><li>虚拟主机</li><li>负载均衡器</li><li>数据库</li><li>文件存储</li><li>&mldr;</li></ul><p>那么在公有云的环境中，我们一般怎么做？</p><p>在云厂商提供的前端管理页面上手动操作吗？</p><p>这也太费劲了吧，尤其是当基础设施越来越多、越来越复杂、以及跨多个云环境的时候，这些基础设施的配置和管理便会碰到一个巨大的挑战。</p><h2 id=terraform>Terraform
<a class=heading-link href=#terraform><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>为了解决上述问题，Terrafrom 应运而生。</p><p>使用 Terraform ，我们只需要编写简单的声明式代码，形如：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource &#34;alicloud_db_instance&#34; &#34;instance&#34; {
</span></span><span style=display:flex><span>  engine           = &#34;MySQL&#34;
</span></span><span style=display:flex><span>  engine_version   = &#34;5.6&#34;
</span></span><span style=display:flex><span>  instance_type    = &#34;rds.mysql.s1.small&#34;
</span></span><span style=display:flex><span>  instance_storage = &#34;10&#34;
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后执行几个简单的 terraform 命令便可以轻松创建一个阿里云的数据库实例。</p><p><img src=https://raw.githubusercontent.com/RifeWang/images/master/terraform/terraform.png alt=terraform></p><p>这就是 <code>Infrastructure as code</code> 基础设施即代码。也就是通过代码而不是手动流程来管理和配置基础设施。</p><p>正如其官方文档所述，与手动管理基础设施相比，使用 Terraform 有以下几个优势：</p><ul><li>Terraform 可以轻松管理多个云平台上的基础设施。</li><li>使用人类可读的声明式的配置语言，有助于快速编写基础设施代码。</li><li>Terraform 的状态允许您在整个部署过程中跟踪资源更改。</li><li>可以对这些基础设施代码进行版本控制，从而安全地进行协作。</li></ul><h3 id=provider--module>Provider & Module
<a class=heading-link href=#provider--module><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>你也许会感到困惑，我只是简单的应用了所写的声明式代码，怎么就构建出来了基础设施，这中间发生了什么？</p><p>其实简而言之就是 terraform 在执行的过程中内部调用了基础设施平台提供的 API 。</p><p><img src=https://raw.githubusercontent.com/RifeWang/images/master/terraform/intro-terraform-apis.png alt=provider></p><p>每个基础设施平台都会把对自身资源的操作统一封装打包成一个 provider 。provider 的概念就好像是编程语言中的一个依赖库。</p><p>在 terraform 中引用 provider ：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>terraform {
</span></span><span style=display:flex><span>  required_providers {
</span></span><span style=display:flex><span>    alicloud = {
</span></span><span style=display:flex><span>      source = &#34;aliyun/alicloud&#34;
</span></span><span style=display:flex><span>      version = &#34;1.161.0&#34;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>provider &#34;alicloud&#34; {
</span></span><span style=display:flex><span>  # Configuration options
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>我们在写代码的时候经常会把某些可重用的部分剥离出来作为一个模块，而在 terraform 中，对基础设施的管理也是如此，我们能够把可重用的 terraform 配置组成 module 模块，我们即可以在我们 local 本地自己编写模块，也可以直接使用第三方组织好并且公开发布的 remote 模块。</p><p><img src=https://raw.githubusercontent.com/RifeWang/images/master/terraform/terraform-provider-module.png alt="provider & module"></p><h2 id=最后>最后
<a class=heading-link href=#%e6%9c%80%e5%90%8e><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>本文只是抛砖引玉罢了，有关 terraform 的更多内容还请参考官方文档及其它资料。</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2019 -
2023
凌虚
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>