<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>数据管道 Logstash 入门 - 凌虚 Blog</title><meta name=Description content="数据管道 Logstash 入门"><meta property="og:title" content="数据管道 Logstash 入门"><meta property="og:description" content="数据管道 Logstash 入门"><meta property="og:type" content="article"><meta property="og:url" content="https://rifewang.github.io/logstash/"><meta property="og:image" content="https://rifewang.github.io/images/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-01T00:00:00+08:00"><meta property="article:modified_time" content="2023-02-27T15:51:36+08:00"><meta property="og:site_name" content="凌虚 Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rifewang.github.io/images/avatar.png"><meta name=twitter:title content="数据管道 Logstash 入门"><meta name=twitter:description content="数据管道 Logstash 入门"><meta name=application-name content="凌虚的博客"><meta name=apple-mobile-web-app-title content="凌虚的博客"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://rifewang.github.io/logstash/><link rel=prev href=https://rifewang.github.io/image-search-total/><link rel=next href=https://rifewang.github.io/es-function-score-query/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"数据管道 Logstash 入门","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/rifewang.github.io\/logstash\/"},"image":["https:\/\/rifewang.github.io\/images\/avatar.png"],"genre":"posts","keywords":"Elasticsearch","wordcount":3155,"url":"https:\/\/rifewang.github.io\/logstash\/","datePublished":"2020-11-01T00:00:00+08:00","dateModified":"2023-02-27T15:51:36+08:00","publisher":{"@type":"Organization","name":"凌虚","logo":"https:\/\/rifewang.github.io\/images\/avatar.png"},"author":{"@type":"Person","name":"凌虚"},"description":"数据管道 Logstash 入门"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="凌虚 Blog">凌虚的博客</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="凌虚 Blog">凌虚的博客</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">数据管道 Logstash 入门</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>凌虚</a></span>&nbsp;<span class=post-category>included in <a href=/categories/elasticsearch/><i class="far fa-folder fa-fw" aria-hidden=true></i>Elasticsearch</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-11-01>2020-11-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;3155 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#logstash-是什么>Logstash 是什么</a><ul><li><a href=#为什么要用-logstash->为什么要用 Logstash ？</a></li></ul></li><li><a href=#安装-logstash>安装 logstash</a></li><li><a href=#第一个示例>第一个示例</a><ul><li><a href=#特定名词和字段>特定名词和字段</a></li><li><a href=#字段引用>字段引用</a></li></ul></li><li><a href=#plugin-插件一览>Plugin 插件一览</a><ul><li><a href=#input-plugin><code>Input plugin</code></a></li><li><a href=#output-plugin><code>Output plugin</code></a></li><li><a href=#filter-plugin><code>Filter plugin</code></a></li></ul></li><li><a href=#结语>结语</a></li></ul></nav></div></div><div class=content id=content><h1 id=logstash-入门>Logstash 入门</h1><hr><h2 id=logstash-是什么>Logstash 是什么</h2><p>Logstash 就是一个开源的数据流工具，它会做三件事：</p><ol><li>从数据源拉取数据</li><li>对数据进行过滤、转换等处理</li><li>将处理后的数据写入目标地</li></ol><p>例如：</p><ul><li>监听某个目录下的日志文件，读取文件内容，处理数据，写入 influxdb 。</li><li>从 kafka 中消费消息，处理数据，写入 elasticsearch 。</li></ul><h3 id=为什么要用-logstash->为什么要用 Logstash ？</h3><p>方便省事。</p><p>假设你需要从 kafka 中消费数据，然后写入 elasticsearch ，如果自己编码，你得去对接 kafka 和 elasticsearch 的 API 吧，如果你用 Logstash ，这部分就不用自己去实现了，因为 Logstash 已经为你封装了对应的 <code>plugin</code> 插件，你只需要写一个配置文件形如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>    kafka {
</span></span><span class=line><span class=cl>        # kafka consumer 配置
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>    # 数据处理配置
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>output {
</span></span><span class=line><span class=cl>    elasticsearch {
</span></span><span class=line><span class=cl>        # elasticsearch 输出配置
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>然后运行 logstash 就可以了。</p><p>Logstash 提供了两百多个封装好的 <code>plugin</code> 插件，这些插件被分为三类：</p><ul><li><code>input plugin</code> : 从哪里拉取数据</li><li><code>filter plugin</code> : 数据如何处理</li><li><code>output plugin</code> : 数据写入何处</li></ul><p>使用 logstash 你只要编写一个配置文件，在配置文件中挑选组合这些 <code>plugin</code> 插件，就可以轻松实现数据从输入源到输出源的实时流动。</p><hr><h2 id=安装-logstash>安装 logstash</h2><p>请参数：<a href=https://www.elastic.co/guide/en/logstash/current/installing-logstash.html target=_blank rel="noopener noreffer">官方文档</a></p><hr><h2 id=第一个示例>第一个示例</h2><p>假设你已经安装好了 logstash ，并且可执行文件的路径已经加入到了 PATH 环境变量中。</p><p>下面开始我们的第一个示例，编写 <code>pipeline.conf</code> 文件，内容为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>    stdin {
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>output {
</span></span><span class=line><span class=cl>    stdout {
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>这个配置文件的含义是：</p><ul><li><code>input</code> 输入为 <code>stdin</code>（标准输入）</li><li><code>filter</code> 为空（也就是不进行数据的处理）</li><li><code>output</code> 输出为 <code>stdout</code>（标准输出）</li></ul><p>执行命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>logstash -f pipeline.conf
</span></span></code></pre></td></tr></table></div></div><p>等待 logstash 启动完毕，输入 hello world 然后回车, 你就会看到以下输出内容:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>       &#34;message&#34; =&gt; &#34;hello world&#34;,
</span></span><span class=line><span class=cl>      &#34;@version&#34; =&gt; &#34;1&#34;,
</span></span><span class=line><span class=cl>    &#34;@timestamp&#34; =&gt; 2020-11-01T08:25:10.987Z,
</span></span><span class=line><span class=cl>          &#34;host&#34; =&gt; &#34;local&#34;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>我们输入的内容已经存在于 <code>message</code> 字段中了。</p><p>当你输入其他内容后也会看到类似的输出。</p><p>至此，我们的第一个示例已经完成，正如配置文件中所定义的，Logstash 从 stdin 标准输入读取数据，不对源数据做任何处理，然后输出到 stdout 标准输出。</p><h3 id=特定名词和字段>特定名词和字段</h3><ul><li><code>event</code> : 数据在 logstash 中被包装成 <code>event</code> 事件的形式从 input 到 filter 再到 output 流转。</li><li><code>@timestamp</code> : 特殊字段，标记 event 发生的时间。</li><li><code>@version</code> : 特殊字段，标记 event 的版本号。</li><li><code>message</code> : 源数据内容。</li><li><code>@metadata</code> : 元数据，key/value 的形式，是否有数据得看具体插件，例如 kafka 的 input 插件会在 <code>@metadata</code> 里记录 topic、consumer_group、partition、offset 等一些元数据。</li><li><code>tags</code> : 记录 tag 的字符串数组。</li></ul><h3 id=字段引用>字段引用</h3><p>在配置文件中，可以通过 <code>[field]</code> 的形式引用字段内容，如果在字符串中，则可以通过 <code>%{[field]}</code> 的方式进行引用。</p><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>    kafka {
</span></span><span class=line><span class=cl>        # kafka 配置
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>    # 引用 log_level 字段的内容进行判断
</span></span><span class=line><span class=cl>    if [log_level] == &#34;debug&#34; {
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>output {
</span></span><span class=line><span class=cl>  elasticsearch {
</span></span><span class=line><span class=cl>    # %{+yyyy.MM.dd} 来源于 @timestamp
</span></span><span class=line><span class=cl>    index =&gt; &#34;log-%{+yyyy.MM.dd}&#34;
</span></span><span class=line><span class=cl>    document_type =&gt; &#34;_doc&#34;
</span></span><span class=line><span class=cl>    document_id =&gt; &#34;%{[@metadata][kafka][key]}&#34;
</span></span><span class=line><span class=cl>    hosts =&gt; [&#34;127.0.0.1:9200&#34;]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=plugin-插件一览>Plugin 插件一览</h2><p>用好 Logstash 的第一步就是熟悉 plugin 插件，只有熟悉了这些插件你才能快速高效的建立数据管道。</p><h3 id=input-plugin><code>Input plugin</code></h3><p><code>Input</code> 插件定义了数据源，即 logstash 从哪里拉取数据。</p><ul><li><code>beats</code> : 从 <a href=https://www.elastic.co/cn/beats/ target=_blank rel="noopener noreffer">Elastic Beats</a> 框架中接收数据。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  beats {
</span></span><span class=line><span class=cl>    port =&gt; 5044
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>dead_letter_queue</code> : 从 Logstash 自己的 <a href=https://www.elastic.co/guide/en/logstash/current/dead-letter-queues.html target=_blank rel="noopener noreffer">dead letter queue</a> 中拉取数据，目前 dead letter queue 只支持记录 output 为 elasticsearch 时写入 400 或 404 的数据。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  dead_letter_queue {
</span></span><span class=line><span class=cl>    path =&gt; &#34;/var/logstash/data/dead_letter_queue&#34;
</span></span><span class=line><span class=cl>    start_timestamp =&gt; &#34;2017-04-04T23:40:37&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>elasticsearch</code> : 从 elasticsearch 中读取 search query 的结果。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  elasticsearch {
</span></span><span class=line><span class=cl>    hosts =&gt; &#34;localhost&#34;
</span></span><span class=line><span class=cl>    query =&gt; &#39;{ &#34;query&#34;: { &#34;match&#34;: { &#34;statuscode&#34;: 200 } } }&#39;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>exec</code> : 定期执行一个 shell 命令，然后捕获其输出。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  exec {
</span></span><span class=line><span class=cl>    command =&gt; &#34;ls&#34;
</span></span><span class=line><span class=cl>    interval =&gt; 30
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>file</code> : 从文件中流式读取内容。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  file {
</span></span><span class=line><span class=cl>    path =&gt; [&#34;/var/log/*.log&#34;, &#34;/var/log/message&#34;]
</span></span><span class=line><span class=cl>    start_position =&gt; &#34;beginning&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>generator</code> : 生成随机数据。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  generator {
</span></span><span class=line><span class=cl>    count =&gt; 3
</span></span><span class=line><span class=cl>    lines =&gt; [
</span></span><span class=line><span class=cl>      &#34;line 1&#34;,
</span></span><span class=line><span class=cl>      &#34;line 2&#34;,
</span></span><span class=line><span class=cl>      &#34;line 3&#34;
</span></span><span class=line><span class=cl>    ]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>github</code> : 从 github webhooks 中读取数据。</li><li><code>graphite</code> : 接受 graphite 的 metrics 指标数据。</li><li><code>heartbeat</code> : 生成心跳信息。这样做的一般目的是测试 Logstash 的性能和可用性。</li><li><code>http</code> : Logstash 接受 http 请求作为数据。</li><li><code>http_poller</code> : Logstash 发起 http 请求，读取响应数据。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  http_poller {
</span></span><span class=line><span class=cl>    urls =&gt; {
</span></span><span class=line><span class=cl>      test1 =&gt; &#34;http://localhost:9200&#34;
</span></span><span class=line><span class=cl>      test2 =&gt; {
</span></span><span class=line><span class=cl>        method =&gt; get
</span></span><span class=line><span class=cl>        user =&gt; &#34;AzureDiamond&#34;
</span></span><span class=line><span class=cl>        password =&gt; &#34;hunter2&#34;
</span></span><span class=line><span class=cl>        url =&gt; &#34;http://localhost:9200/_cluster/health&#34;
</span></span><span class=line><span class=cl>        headers =&gt; {
</span></span><span class=line><span class=cl>          Accept =&gt; &#34;application/json&#34;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>     }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    request_timeout =&gt; 60
</span></span><span class=line><span class=cl>    schedule =&gt; { cron =&gt; &#34;* * * * * UTC&#34;}
</span></span><span class=line><span class=cl>    codec =&gt; &#34;json&#34;
</span></span><span class=line><span class=cl>    metadata_target =&gt; &#34;http_poller_metadata&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>imap</code> : 从 IMAP 服务器读取邮件。</li><li><code>jdbc</code> : 通过 JDBC 接口导入数据库中的数据。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  jdbc {
</span></span><span class=line><span class=cl>    jdbc_driver_library =&gt; &#34;mysql-connector-java-5.1.36-bin.jar&#34;
</span></span><span class=line><span class=cl>    jdbc_driver_class =&gt; &#34;com.mysql.jdbc.Driver&#34;
</span></span><span class=line><span class=cl>    jdbc_connection_string =&gt; &#34;jdbc:mysql://localhost:3306/mydb&#34;
</span></span><span class=line><span class=cl>    jdbc_user =&gt; &#34;mysql&#34;
</span></span><span class=line><span class=cl>    parameters =&gt; { &#34;favorite_artist&#34; =&gt; &#34;Beethoven&#34; }
</span></span><span class=line><span class=cl>    schedule =&gt; &#34;* * * * *&#34;
</span></span><span class=line><span class=cl>    statement =&gt; &#34;SELECT * from songs where artist = :favorite_artist&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>kafka</code> : 消费 kafka 中的消息。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>input {
</span></span><span class=line><span class=cl>  kafka {
</span></span><span class=line><span class=cl>    bootstrap_servers =&gt; &#34;127.0.0.1:9092&#34;
</span></span><span class=line><span class=cl>    group_id =&gt; &#34;consumer_group&#34;
</span></span><span class=line><span class=cl>    topics =&gt; [&#34;kafka_topic&#34;]
</span></span><span class=line><span class=cl>    enable_auto_commit =&gt; true
</span></span><span class=line><span class=cl>    auto_commit_interval_ms =&gt; 5000
</span></span><span class=line><span class=cl>    auto_offset_reset =&gt; &#34;latest&#34;
</span></span><span class=line><span class=cl>    decorate_events =&gt; true
</span></span><span class=line><span class=cl>    isolation_level =&gt; &#34;read_uncommitted&#34;
</span></span><span class=line><span class=cl>    max_poll_records =&gt; 1000
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>rabbitmq</code> : 从 RabbitMQ 队列中拉取数据。</li><li><code>redis</code> : 从 redis 中读取数据。</li><li><code>stdin</code> : 从标准输入读取数据。</li><li><code>syslog</code> : 读取 syslog 数据。</li><li><code>tcp</code> : 通过 TCP socket 读取数据。</li><li><code>udp</code> : 通过 udp 读取数据。</li><li><code>unix</code> : 通过 UNIX socket 读取数据。</li><li><code>websocket</code> : 通过 websocket 协议 读取数据。</li></ul><h3 id=output-plugin><code>Output plugin</code></h3><p><code>Output</code> 插件定义了数据的输出地，即 logstash 将数据写入何处。</p><ul><li><code>csv</code> : 将数据写入 csv 文件。</li><li><code>elasticsearch</code> : 写入 Elasticsearch 。</li><li><code>email</code> : 发送 email 邮件。</li><li><code>exec</code> : 执行命令。</li><li><code>file</code> : 写入磁盘文件。</li><li><code>graphite</code> : 写入 Graphite 。</li><li><code>http</code> : 发送 http 请求。</li><li><code>influxdb</code> : 写入 InfluxDB 。</li><li><code>kafka</code> : 写入 Kafka 。</li><li><code>mongodb</code> : 写入 MongoDB 。</li><li><code>opentsdb</code> : 写入 OpenTSDB 。</li><li><code>rabbitmq</code> : 写入 RabbitMQ 。</li><li><code>redis</code> : 使用 RPUSH 的方式写入到 Redis 队列。</li><li><code>sink</code> : 将数据丢弃，不写入任何地方。</li><li><code>syslog</code> : 将数据发送到 syslog 服务端。</li><li><code>tcp</code> : 发送 TCP socket。</li><li><code>udp</code> : 发送 UDP 。</li><li><code>webhdfs</code> : 通过 webhdfs REST API 写入 HDFS 。</li><li><code>websocket</code> : 推送 websocket 消息 。</li></ul><h3 id=filter-plugin><code>Filter plugin</code></h3><p><code>Filter</code> 插件定义对数据进行如何处理。</p><ul><li><code>aggregate</code> : 聚合数据。</li><li><code>alter</code> : 修改数据。</li><li><code>bytes</code> : 将存储大小如 &ldquo;123 MB&rdquo; 或 &ldquo;5.6gb&rdquo; 的字符串表示形式解析为以字节为单位的数值。</li><li><code>cidr</code> : 检查 IP 地址是否在指定范围内。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  cidr {
</span></span><span class=line><span class=cl>    add_tag =&gt; [ &#34;testnet&#34; ]
</span></span><span class=line><span class=cl>    address =&gt; [ &#34;%{src_ip}&#34;, &#34;%{dst_ip}&#34; ]
</span></span><span class=line><span class=cl>    network =&gt; [ &#34;192.0.2.0/24&#34; ]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>cipher</code> : 对数据进行加密或解密。</li><li><code>clone</code> : 复制 event 事件。</li><li><code>csv</code> : 解析 CSV 格式的数据。</li><li><code>date</code> : 解析字段中的日期数据。</li></ul><p>示例，匹配输入的 timestamp 字段，然后替换 @timestamp ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  date {
</span></span><span class=line><span class=cl>    match =&gt; [&#34;timestamp&#34;, &#34;dd/MMM/yyyy:HH:mm:ss ZZ&#34;]
</span></span><span class=line><span class=cl>    target =&gt; &#34;@timestamp&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>dissect</code> : 使用 <code>%{}</code> 的形式拆分字符串并提取出特定内容，比较常用，具体语法见 <a href=https://www.elastic.co/guide/en/logstash/current/plugins-filters-dissect.html target=_blank rel="noopener noreffer">dissect 文档</a>。</li><li><code>drop</code> : 丢弃这个 event 。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  if [loglevel] == &#34;debug&#34; {
</span></span><span class=line><span class=cl>    drop { }
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>elapsed</code> : 通过记录开始和结束时间跟踪 event 的耗时。</li><li><code>elasticsearch</code> : 在 elasticsearch 中进行搜索，并将数据复制到当前 event 中。</li><li><code>environment</code> : 将环境变量中的数据存储到 @metadata 字段中。</li><li><code>extractnumbers</code> : 提取字符串中找到的所有数字。</li><li><code>fingerprint</code> : 根据一个或多个字段的内容创建哈希值，并存储到新的字段中。</li><li><code>geoip</code> : 使用绑定的 <a href=https://dev.maxmind.com/geoip/geoip2/geolite2/ target=_blank rel="noopener noreffer">GeoLite2</a> 数据库添加有关 IP 地址的地理位置的信息，这个插件非常有用，你可以根据 IP 地址得到对应的国家、省份、城市、经纬度等地理位置数据。</li></ul><p>示例，通过 clent_ip 字段获取对应的地理位置信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  geoip {
</span></span><span class=line><span class=cl>    cache_size =&gt; 1000
</span></span><span class=line><span class=cl>    default_database_type =&gt; &#34;City&#34;
</span></span><span class=line><span class=cl>    source =&gt; &#34;clent_ip&#34;
</span></span><span class=line><span class=cl>    target =&gt; &#34;geo&#34;
</span></span><span class=line><span class=cl>    tag_on_failure =&gt; [&#34;_geoip_city_fail&#34;]
</span></span><span class=line><span class=cl>    add_field =&gt; {
</span></span><span class=line><span class=cl>      &#34;geo_country_name&#34; =&gt; &#34;%{[geo][country_name]}&#34;
</span></span><span class=line><span class=cl>      &#34;geo_region_name&#34; =&gt; &#34;%{[geo][region_name]}&#34;
</span></span><span class=line><span class=cl>      &#34;geo_city_name&#34; =&gt; &#34;%{[geo][city_name]}&#34;
</span></span><span class=line><span class=cl>      &#34;geo_location&#34; =&gt; &#34;%{[geo][latitude]},%{[geo][longitude]}&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    remove_field =&gt; [&#34;geo&#34;]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>grok</code> : 通过正则表达式去处理字符串，比较常用，具体语法见 <a href=https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html target=_blank rel="noopener noreffer">grok 文档</a>。</li><li><code>http</code> : 与外部 web services/REST APIs 集成。</li><li><code>i18n</code> : 从字段中删除特殊字符。</li><li><code>java_uuid</code> : 生成 UUID 。</li><li><code>jdbc_static</code> : 从远程数据库中读取数据，然后丰富 event 。</li><li><code>jdbc_streaming</code> : 执行 SQL 查询然后将结果存储到指定字段。</li><li><code>json</code> : 解析 json 字符串，生成 field 和 value。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  json {
</span></span><span class=line><span class=cl>    skip_on_invalid_json =&gt; true
</span></span><span class=line><span class=cl>    source =&gt; &#34;message&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>如果输入的 message 字段是 json 字符串如 <code>"{"a": 1, "b": 2}"</code>, 那么解析后就会增加两个字段，字段名分别是 a 和 b 。</p><ul><li><code>kv</code> : 解析 key=value 形式的数据。</li><li><code>memcached</code> : 与外部 memcached 集成。</li><li><code>metrics</code> : logstash 在内存中去聚合指标数据。</li><li><code>mutate</code> : 对字段进行一些常规更改。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  mutate {
</span></span><span class=line><span class=cl>    split =&gt; [&#34;hostname&#34;, &#34;.&#34;]
</span></span><span class=line><span class=cl>    add_field =&gt; { &#34;shortHostname&#34; =&gt; &#34;%{hostname[0]}&#34; }
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  mutate {
</span></span><span class=line><span class=cl>    rename =&gt; [&#34;shortHostname&#34;, &#34;hostname&#34;]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>prune</code> : 通过黑白名单的方式删除多余的字段。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  prune {
</span></span><span class=line><span class=cl>    blacklist_names =&gt; [ &#34;method&#34;, &#34;(referrer|status)&#34;, &#34;${some}_field&#34; ]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>ruby</code> : 执行 ruby 代码。</li></ul><p>示例，解析 <code>http://example.com/abc?q=haha</code> 形式字符串中的 query 参数 q 的值 ：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  ruby {
</span></span><span class=line><span class=cl>    code =&gt; &#34;
</span></span><span class=line><span class=cl>      require &#39;cgi&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      req = event.get(&#39;request_uri&#39;).split(&#39;?&#39;)
</span></span><span class=line><span class=cl>      query = &#39;&#39;
</span></span><span class=line><span class=cl>      if req.length &gt; 1
</span></span><span class=line><span class=cl>        query = req[1]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        qh = CGI::parse(query)
</span></span><span class=line><span class=cl>        event.set(&#39;search_q&#39;, qh[&#39;q&#39;][0])
</span></span><span class=line><span class=cl>      end
</span></span><span class=line><span class=cl>    &#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>在 ruby 代码中，字段的获取和设置通过 <code>event.get()</code> 和 <code>event.set()</code> 方法进行操作。</p><ul><li><code>sleep</code> : 休眠指定时间。</li><li><code>split</code> : 拆分字段。</li><li><code>throttle</code> : 限流，限制 event 数量。</li><li><code>translate</code> : 根据指定的字典文件将数据进行对应转换。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  translate {
</span></span><span class=line><span class=cl>    field =&gt; &#34;[http_status]&#34;
</span></span><span class=line><span class=cl>    destination =&gt; &#34;[http_status_description]&#34;
</span></span><span class=line><span class=cl>    dictionary =&gt; {
</span></span><span class=line><span class=cl>      &#34;100&#34; =&gt; &#34;Continue&#34;
</span></span><span class=line><span class=cl>      &#34;101&#34; =&gt; &#34;Switching Protocols&#34;
</span></span><span class=line><span class=cl>      &#34;200&#34; =&gt; &#34;OK&#34;
</span></span><span class=line><span class=cl>      &#34;500&#34; =&gt; &#34;Server Error&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    fallback =&gt; &#34;I&#39;m a teapot&#34;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>truncate</code> : 将字段内容超出长度的部分裁剪掉。</li><li><code>urldecode</code> : 对 urlencoded 的内容进行解码。</li><li><code>useragent</code> : 解析 user-agent 的内容得到诸如设备、操作系统、版本等信息。</li></ul><p>示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filter {
</span></span><span class=line><span class=cl>  # ua_device : 设备
</span></span><span class=line><span class=cl>  # ua_name : 浏览器
</span></span><span class=line><span class=cl>  # ua_os : 操作系统
</span></span><span class=line><span class=cl>  useragent {
</span></span><span class=line><span class=cl>    lru_cache_size =&gt; 1000
</span></span><span class=line><span class=cl>    source =&gt; &#34;user_agent&#34;
</span></span><span class=line><span class=cl>    target =&gt; &#34;ua&#34;
</span></span><span class=line><span class=cl>    add_field =&gt; {
</span></span><span class=line><span class=cl>      &#34;ua_device&#34; =&gt; &#34;%{[ua][device]}&#34;
</span></span><span class=line><span class=cl>      &#34;ua_name&#34; =&gt; &#34;%{[ua][name]}&#34;
</span></span><span class=line><span class=cl>      &#34;ua_os&#34; =&gt; &#34;%{[ua][os_name]}&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    remove_field =&gt; [&#34;ua&#34;]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><code>uuid</code> : 生成 UUID 。</li><li><code>xml</code> : 解析 XML 格式的数据。</li></ul><hr><h2 id=结语>结语</h2><p>Logstash 的插件除了本文提到的这些之外还有很多，想要详细的了解每个插件如何使用还是要去查阅官方文档。</p><p>得益于 Logstash 的插件体系，你只需要编写一个配置文件，声明使用哪些插件，就可以很轻松的构建数据管道。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-27</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://rifewang.github.io/logstash/ data-title="数据管道 Logstash 入门" data-hashtags=Elasticsearch><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://rifewang.github.io/logstash/ data-hashtag=Elasticsearch><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://rifewang.github.io/logstash/ data-title="数据管道 Logstash 入门"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://rifewang.github.io/logstash/ data-title="数据管道 Logstash 入门"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://rifewang.github.io/logstash/ data-title="数据管道 Logstash 入门"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/elasticsearch/>Elasticsearch</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/image-search-total/ class=prev rel=prev title=又拍图片管家亿级图像之搜图系统的两代演进及底层原理><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>又拍图片管家亿级图像之搜图系统的两代演进及底层原理</a>
<a href=/es-function-score-query/ class=next rel=next title="Elasticsearch 自定义打分 Function score query">Elasticsearch 自定义打分 Function score query<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>凌虚</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>